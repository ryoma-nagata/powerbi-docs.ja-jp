---
title: Power BI Premium でワークロードを構成する方法
description: Power BI Premium 容量でワークロードを構成する方法について説明します。
author: mgblythe
ms.author: mblythe
manager: kfile
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-admin
ms.topic: conceptual
ms.date: 08/21/2019
LocalizationGroup: Premium
ms.openlocfilehash: 2d2eb51c5aad44572f1b427248fd85ef19a6306f
ms.sourcegitcommit: e62889690073626d92cc73ff5ae26c71011e012e
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/23/2019
ms.locfileid: "69985695"
---
# <a name="configure-workloads-in-a-premium-capacity"></a>Premium 容量でワークロードを構成する

この記事では、Power BI Premium 容量に対するワークロードの構成と有効化について説明します。 既定では、容量は、Power BI のクエリの実行に関連付けられているワークロードのみをサポートします。 **[AI (Cognitive Services)](service-cognitive-services.md)** 、 **[データフロー](service-dataflows-overview.md#dataflow-capabilities-on-power-bi-premium)** 、および **[ページ分割されたレポート](paginated-reports-save-to-power-bi-service.md)** に対する追加のワークロードの有効化と構成を行うこともできます。

## <a name="default-memory-settings"></a>既定のメモリ設定

クエリのワークロードは、Premium 容量の SKU によって決定されるリソース用に最適化され、そのリソースによって制限されます。 Premium 容量では、容量のリソースを使用できる追加のワークロードもサポートされます。 これらのワークロードの既定のメモリの値は、SKU で使用可能な容量ノードに基づきます。 最大メモリの設定は、累積ではありません。 指定された最大値までのメモリは、AI とデータフローには動的に割り当てられますが、ページ分割されたレポートには静的に割り当てられます。

### <a name="microsoft-office-skus-for-software-as-a-service-saas-scenarios"></a>サービスとしてのソフトウェア (SaaS) シナリオにおける Microsoft Office の SKU

|                     | EM2                      | EM3                       | P1                      | P2                       | P3                       |
|---------------------|--------------------------|--------------------------|-------------------------|--------------------------|--------------------------|
| AI | 該当なし | 該当なし | 20% (既定値)、20% (最小値) | 20% (既定値)、10% (最小値) | 20% (既定値)、5% (最小値) |
| データフロー | 該当なし |20% (既定値)、12% (最小値)  | 20% (既定値)、5% (最小値)  | 20% (既定値)、3% (最小値) | 20% (既定値)、2% (最小値)  |
| ページ分割されたレポート | 該当なし |該当なし | 20% (既定値)、10% (最小値) | 20% (既定値)、5% (最小値) | 20% (既定値)、2.5% (最小値) |
| | | | | | |

### <a name="microsoft-azure-skus-for-platform-as-a-service-paas-scenarios"></a>サービスとしてのプラットフォーム (PaaS) シナリオにおける Microsoft Azure の SKU

|                  | A1                       | A2                       | A3                      | A4                       | A5                      | A6                        |
|-------------------|--------------------------|--------------------------|-------------------------|--------------------------|-------------------------|---------------------------|
| AI | 該当なし                      | 20% (既定値)、100% (最小値)                     | 20% (既定値)、50% (最小値)                     | 20% (既定値)、20% (最小値) | 20% (既定値)、10% (最小値) | 20% (既定値)、5% (最小値) |
| データフロー         | 40% (既定値)、40% (最小値) | 24% (既定値)、24% (最小値) | 20% (既定値)、12% (最小値) | 20% (既定値)、5% (最小値)  | 20% (既定値)、3% (最小値) | 20% (既定値)、2% (最小値)   |
| ページ分割されたレポート | 該当なし                      | 該当なし                      | 該当なし                     | 20% (既定値)、10% (最小値) | 20% (既定値)、5% (最小値) | 20% (既定値)、2.5% (最小値) |
| | | | | | |

## <a name="workload-settings"></a>ワークロードの設定

### <a name="ai-preview"></a>AI (プレビュー)

AI ワークロードを使用すると、Power BI で cognitive services と自動 Machine Learning を使用できます。 次の設定を使用して、ワークロードの動作を制御します。

| 設定名 | 説明 |
|---------------------------------|----------------------------------------|
| **最大メモリ (%)** | 容量のうち、AI プロセスが使用できるメモリの最大割合。 |
| **Power BI Desktop からの使用を許可します** | この設定は将来使用するために予約されており、すべてのテナントに表示されるわけではありません。 |
| **機械学習モデルの構築を許可します** | ビジネス アナリストが Power BI で直接機械学習モデルをトレーニング、検証、および呼び出すことができるかどうかを指定します。 詳細については、「[Power BI での自動 Machine Learning (プレビュー)](service-machine-learning-automated.md)」を参照してください。 |
| **AI 要求に対して並列処理を有効にします** | AI 要求を並列で実行できるかどうかを指定します。 |
|  |  |

### <a name="datasets"></a>データセット

データセット ワークロードは既定で有効になっており、無効にすることはできません。 次の設定を使用して、ワークロードの動作を制御します。

| 設定名 | 説明 |
|---------------------------------|----------------------------------------|
| **最大メモリ (%)** | 容量のうち、データセットが使用できるメモリの最大割合。 |
| **XMLA エンドポイント** | クライアント アプリケーションからの接続で、ワークスペース レベルとアプリ レベルで設定されたセキュリティ グループ メンバーシップが優先されることを指定します。 詳細については、「[クライアント アプリケーションとツールでデータセットに接続する](service-premium-connect-tools.md)」を参照してください。 |
| **Max Intermediate Row Set Count (中間行セットの最大数)** | DirectQuery によって返される中間行の最大数。 既定値は 1,000,000 に設定されており、許容範囲は 100,000 - 2,147,483,647 です。 リソースの消費量が多い、または設計が不十分なレポートの影響を制御するには、この設定を使用します。 |
| **オフライン データセットの最大サイズ (GB)** | メモリ内のオフライン データセットの最大サイズ。 これはディスク上の圧縮サイズです。 既定値は SKU によって設定され、許容範囲は 0.1 - 10 GB です。 レポート作成者が、容量に悪影響を及ぼす可能性のある大規模なデータセットを発行できないようにするには、この設定を使用します。 |
| **Max Result Row Set Count (結果行セットの最大数)** | DAX クエリで返される行の最大数。 既定値は -1 (無制限) に設定されており、許容範囲は 100,000 - 2,147,483,647 です。 リソースの消費量が多い、または設計が不十分なレポートの影響を制御するには、この設定を使用します。 |
| **クエリのメモリ制限 (%)** | クエリまたは DAX メジャーの一時的な結果に使用できるメモリの最大割合。 リソースの消費量が多い、または設計が不十分なレポートの影響を制御するには、この設定を使用します。 |
| **クエリのタイムアウト (秒)** | クエリがタイムアウトするまでの最大時間。既定値は 3,600 秒 (1 時間) です。 値 0 は、クエリがタイムアウトしないことを指定します。 実行時間の長いクエリをより適切に管理するには、この設定を使用します。 |
|  |  |  |

### <a name="dataflows"></a>データフロー

データフロー ワークロードを使用すると、データフローのセルフサービスのデータ準備を使用して、データの取り込み、変換、統合、および強化を行うことができます。 次の設定を使用して、ワークロードの動作を制御します。

| 設定名 | 説明 |
|---------------------------------|----------------------------------------|
| **最大メモリ (%)** | 容量のうち、データフローが使用できるメモリの最大割合。 |
| **拡張データフロー コンピューティング エンジン (プレビュー)** | このオプションを有効にすると、大規模なデータ ボリュームを操作するときに、計算されたエンティティの計算を最大 20 倍高速化できます。 **新しいエンジンをアクティブ化するには、容量を再起動する必要があります。** 詳細については、「[拡張データフロー コンピューティング エンジン](#enhanced-dataflows-compute-engine)」を参照してください。 |
| **コンテナー サイズ** | データフロー内の各エンティティに対してデータフローが使用するコンテナーの最大サイズ。 既定値は 700 MB です。 詳細については、「[コンテナー サイズ](#container-size)」を参照してください。 |
|  |  |

#### <a name="enhanced-dataflows-compute-engine"></a>拡張データフロー コンピューティング エンジン

新しいコンピューティング エンジンを活用するために、データの取り込みを個別のデータフローに分割し、変換ロジックを異なるデータフローの計算されたエンティティに配置します。 コンピューティング エンジンは、既存のデータフローを参照するデータフローで動作するため、この方法をお勧めします。 インジェスト データフローでは機能しません。 このガイダンスに従うことで、最適なパフォーマンスを得るために、新しいコンピューティング エンジンが結合やマージなどの変換手順を確実に処理できるようになります。

#### <a name="container-size"></a>コンテナー サイズ

データフローを更新すると、データフロー ワークロードによってデータフロー内の各エンティティに対してコンテナーが生成されます。 各コンテナーでは、**[コンテナー サイズ] の設定で指定されたボリュームまでのメモリを使用できます。 すべての SKU の既定値は 700 MB です。 次の場合は、この設定を変更することができます。

- データフローの更新に時間がかかりすぎるか、データフローの更新がタイムアウトで失敗する。
- データフロー エンティティに、結合などの計算手順が含まれている。  

[Power BI Premium 容量メトリック](service-admin-premium-monitor-capacity.md) アプリを使用して、データフロー ワークロードのパフォーマンスを分析することをお勧めします。

場合によっては、コンテナー サイズを増やしてもパフォーマンスが向上しないことがあります。 たとえば、データフローで大量の計算を実行せずに、ソースからのみデータを取得する場合、コンテナー サイズを変更しても改善しない可能性があります。 コンテナー サイズを大きくすることで、データフロー ワークロードでエンティティの更新操作により多くのメモリを割り当てることができる場合は、改善する可能性があります。 割り当てられるメモリを増やすことで、大量の計算されたエンティティを更新するのにかかる時間を短縮できます。

コンテナー サイズの値は、データフロー ワークロードの最大メモリを超えることはできません。 たとえば、P1 容量に 25 GB のメモリがあるとします。 データフロー ワークロードの最大メモリ (%) が 20% に設定されている場合、コンテナー サイズ (MB) は 5,000 を超えることはできません。 いずれの場合も、より大きい値を設定したとしても、コンテナー サイズが最大メモリを超えることはできません。

### <a name="paginated-reports"></a>ページ分割されたレポート

ページ分割されたレポート ワークロードを使用すると、標準の SQL Server Reporting Services 形式に基づいて、Power BI サービスでページ分割されたレポートを実行できます。 次の設定を使用して、ワークロードの動作を制御します。

| 設定名 | 説明 |
|---------------------------------|----------------------------------------|
| **最大メモリ (%)** | 容量のうち、ページ分割されたレポートが使用できるメモリの最大割合。 |
|  |  |

ページ分割されたレポートでは、レポートをレンダリングするときにカスタム コードを実行できます。 たとえば、コンテンツに基づいてテキストの色を動的に変更すると、追加のメモリがかかる可能性があります。 Power BI Premium は、容量内に含まれる領域で、ページ分割されたレポートを実行します。 ワークロードがアクティブ*かどうかに関係なく*、指定した最大メモリが使用されます。 最大メモリの設定を既定値から変更する場合は、他のワークロードに悪影響を及ぼさない程度の少量のメモリを設定してください。

場合によっては、ページ分割されたレポート ワークロードが使用できなくなることがあります。 その場合、管理ポータルではワークロードがエラー状態であると表示され、ユーザーに対してはレポートの表示がタイムアウトしたと表示されます。 この問題を軽減するには、ワークロードを無効にしてからもう一度有効にしてください。

## <a name="configure-workloads"></a>ワークロードを構成する

容量の使用可能なリソースを最大化するには、使用する場合にのみワークロードを有効にします。 メモリ設定およびその他の設定を変更するのは、既定の設定では容量のリソース要件が満たされないことが判明した場合のみにしてください。

### <a name="to-configure-workloads-in-the-power-bi-admin-portal"></a>Power BI 管理ポータルでワークロードを構成するには

1. **[容量の設定]**  >  **[Premium 容量]** で、容量を選択します。

1. **[その他のオプション]** で **[ワークロード]** を展開します。

1. 1 つ以上のワークロードを有効にして、 **[最大メモリ]** の値とその他の設定を設定します。

1. **[適用]** を選びます。

### <a name="rest-api"></a>REST API

ワークロードの有効化と容量への割り当ては、[Capacities](https://docs.microsoft.com/rest/api/power-bi/capacities) REST API を使用します。

## <a name="monitoring-workloads"></a>ワークロードの監視

[Power BI Premium 容量メトリック アプリ](service-admin-premium-monitor-capacity.md)のデータセット、データフロー、およびページ分割されたレポートのメトリックにより、容量に対して使用可能なワークロードを監視できます。 

## <a name="next-steps"></a>次の手順

[Power BI Premium の容量の最適化](service-premium-capacity-optimize.md)     
[データフローを使用した Power BI でのセルフサービスのデータ準備](service-dataflows-overview.md)   
[Power BI Premium のページ分割されたレポートとは](paginated-reports-report-builder-power-bi.md)   

他にわからないことがある場合は、 [Power BI コミュニティに質問する](http://community.powerbi.com/)